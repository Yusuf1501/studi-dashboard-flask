{% extends "base.html" %}

{% block title2 %}
    Thesendetail: {{ thesis.title }}
{% endblock %}

{% block content %}
    <div class="container my-5">
        <h1>Thesendetail: {{ thesis.title }}</h1>
        <h3>Abgabedatum: {{ thesis.deadline.strftime('%d.%m.%Y') }}</h3>
        <p>
            {{ thesis.description }}
        </p>

        <!-- Tabelle zur Anzeige und Bearbeitung der Bewertungskriterien -->
        <form action="/thesis/{{ thesis.id }}/update_ratings" method="post">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Kriterium</th>
                        <th>Gewichtung</th>
                        <th>Note</th>
                        <th>Gewichtete Punkte</th>
                        <th>Aktion</th>
                    </tr>
                </thead>
                <tbody>
                    {% for rating in ratings %}
                        <tr>
                            <td><input type="text" class="form-control" name="criterion[]" value="{{ rating.criterion }}"></td>
                            <td><input type="number" class="form-control" name="weight[]" value="{{ rating.weight }}"></td>
                            <td><input type="number" class="form-control" name="rating[]" value="{{ rating.rating }}"></td>
                            <td>{{ rating.weight * rating.rating }}</td>
                            <td>
                                <a href="/thesis/{{ thesis.id }}/rating/delete/{{ rating.id }}" class="btn btn-danger btn-sm"><i class="bi bi-trash"></i> Löschen</a>
                            </td>
                        </tr>
                    {% endfor %}

                    <tr>
                        <td><input type="text" class="form-control" name="new_criterion" placeholder="Neues Kriterium"></td>
                        <td><input type="number" class="form-control" name="new_weight" placeholder="Gewichtung"></td>
                        <td><input type="number" class="form-control" name="new_rating" placeholder="Note"></td>
                        <td></td>
                        <td><button type="submit" class="btn btn-primary"><i class="bi bi-check"></i> Aktualisieren</button></td>
                    </tr>
                </tbody>

                <!-- Fußzeile der Tabelle -->
                <tfoot>
                    <tr>
                        <td colspan="1"><strong>Summen</strong></td>
                        <td>{{ total_weight }}</td>
                        <td></td>
                        <td>{{ total_rating }}</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td colspan="5">Durchschnittsnote: {{ average_rating }}</td>
                    </tr>
                </tfoot>
            </table>
        </form>
    </div>
{% endblock %}
